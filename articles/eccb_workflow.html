<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Orchestrating Microbiome Analysis with Bioconductor (ECCB) • miaDemo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Orchestrating Microbiome Analysis with Bioconductor (ECCB)">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">miaDemo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/eccb_workflow.html">Orchestrating Microbiome Analysis with Bioconductor (ECCB)</a>
    </li>
    <li>
      <a href="../articles/mia_demo.html">Orchestrating Microbiome Analysis with Bioconductor (EuroBioC2024)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/microbiome/miaDemo" class="external-link">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Orchestrating Microbiome Analysis with
Bioconductor (ECCB)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/microbiome/miaDemo/blob/devel/vignettes/eccb_workflow.Rmd" class="external-link"><code>vignettes/eccb_workflow.Rmd</code></a></small>
      <div class="hidden name"><code>eccb_workflow.Rmd</code></div>

    </div>

    
    
<p>Authors: Tuomas Borman, Pande Erawijantari, Giulio Benedetti,
Stefanie Peschel, Leo Lahti. <br> Last modified: 12 September,
2024.</p>
<p><img src="figures/mia_logo.png" width="150"></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>This tutorial introduces the latest advances in Bioconductor tools
and data structures supporting microbiome analysis. We will show how
this can enhance interoperability across omics and walk through a
typical microbiome data science workflow. You will learn from active
developers how to access open microbiome data resources, utilize
optimized data structures, assess community diversity and composition,
integrate taxonomic and functional hierarchies, and visualize microbiome
data. We will follow the online book <a href="https://microbiome.github.io/OMA/docs/devel/" class="external-link">“Orchestrating
Microbiome Analysis with Bioconductor”</a> and Bioconductor
SummarizedExperiment framework, supporting optimized analysis and
integration of hierarchical, multi-domain microbiome data. Participants
are encouraged to install the latest versions of R and Bioconductor.</p>
</div>
<div class="section level3">
<h3 id="pre-requisites">Pre-requisites<a class="anchor" aria-label="anchor" href="#pre-requisites"></a>
</h3>
<ul>
<li>Basic knowledge of R coding</li>
<li>Understanding of microbiome research</li>
</ul>
<p>If your time allows, we recommend to spend some time to explore
beforehand <a href="https://microbiome.github.io/OMA/docs/devel/" class="external-link">Orchestrating
Microbiome Analysis (OMA) online book</a>.</p>
</div>
<div class="section level3">
<h3 id="participation">Participation<a class="anchor" aria-label="anchor" href="#participation"></a>
</h3>
<p>We have instructor-led demonstrations where participants are expected
to follow along. Questions are encouraged at any time during the
workshop.</p>
<p>It is preferred to use your own laptop. You can find help for
installation from <a href="https://microbiome.github.io/OMA/docs/devel/pages/training.html" class="external-link">here</a>.
There are also available <a href="https://workshop.bioconductor.org/" class="external-link">pre-installed virtual
machines</a> by Galaxy/Bioconductor. (Under “EUROBIOC2024” tab, session
called “Package Demo: mia”)</p>
</div>
<div class="section level3">
<h3 id="r-bioconductor-packages-used">
<em>R</em> / <em>Bioconductor</em> packages used<a class="anchor" aria-label="anchor" href="#r-bioconductor-packages-used"></a>
</h3>
<p>In this workshop, we will focus on <a href="https://bioconductor.org/packages/devel/bioc/html/mia.html" class="external-link">the
<em>mia</em> package</a>, which is designed for microbiome data science.
The <em>mia</em> package provides essential tools for analyzing
microbiome data using the <em>SummarizedExperiment</em> framework.</p>
<p>Additionally, we will cover <a href="https://github.com/stefpeschel/NetCoMi" class="external-link">NetCoMi</a> and <a href="https://www.bioconductor.org/packages/devel/bioc/html/iSEEtree.html" class="external-link">iSEEtree</a>
in network and interactive data exploration session, respectively.</p>
</div>
<div class="section level3">
<h3 id="time-outline">Time outline<a class="anchor" aria-label="anchor" href="#time-outline"></a>
</h3>
<table class="table">
<thead><tr class="header">
<th>Activity</th>
<th>Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Bioconductor resources for microbiome data science</td>
<td>30m</td>
</tr>
<tr class="even">
<td>Analysis of community diversity and composition</td>
<td>30m</td>
</tr>
<tr class="odd">
<td>Microbiome data integration</td>
<td>30m</td>
</tr>
<tr class="even">
<td>Coffee break</td>
<td>30m</td>
</tr>
<tr class="odd">
<td>Microbial network analysis</td>
<td>30m</td>
</tr>
<tr class="even">
<td>Interactive microbiome data exploration with iSEEtree</td>
<td>30m</td>
</tr>
<tr class="odd">
<td>Recap and Q&amp;A</td>
<td>30m</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="workshop-goals-and-objectives">Workshop goals and objectives<a class="anchor" aria-label="anchor" href="#workshop-goals-and-objectives"></a>
</h3>
<div class="section level4">
<h4 id="learning-goals">Learning goals<a class="anchor" aria-label="anchor" href="#learning-goals"></a>
</h4>
<ul>
<li><p><strong>Methods for microbiome analysis</strong>: Learn to
harness <em>SummarizedExperiment</em> ecosystem in your
project.</p></li>
<li><p><strong>Data structure</strong>: Understand how to utilize the
<em>TreeSummarizedExperiment</em> class for effective microbiome data
analysis.</p></li>
<li><p><strong>Access resources</strong>: Get familiar with additional
tools and resources, including <a href="https://microbiome.github.io/OMA/docs/devel" class="external-link">the OMA online
book</a>.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h4>
<ul>
<li><p><strong>Analyze and apply methods</strong>: Apply the framework
to process and analyze microbiome data.</p></li>
<li><p><strong>Visualize data</strong>: Generate and interpret common
graphs for microbiome data</p></li>
<li><p><strong>Explore documentation</strong>: Use the <a href="https://microbiome.github.io/OMA/docs/devel" class="external-link">OMA</a> to explore
additional tools and methods.</p></li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="workshop">Workshop<a class="anchor" aria-label="anchor" href="#workshop"></a>
</h2>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this workflow, we demonstrate how to analyze data from publicly
available microbiome resources using Bioconductor methods. We will cover
essential data wrangling steps, explore alpha and beta diversity
metrics, and introduce the fundamentals of data integration and
microbial network analysis. Additionally, we will explore how to utilize
the tools through a graphical interface.</p>
</div>
<div class="section level2">
<h2 id="bioconductor-resources-for-microbiome-data-science">Bioconductor resources for microbiome data science<a class="anchor" aria-label="anchor" href="#bioconductor-resources-for-microbiome-data-science"></a>
</h2>
<div class="section level3">
<h3 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h3>
<p>First, we load the required packages into the session. The following
script ensures that any packages not already installed are automatically
installed.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># List of packages that we need</span></span>
<span><span class="va">packages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ComplexHeatmap"</span>,</span>
<span>    <span class="st">"curatedMetagenomicData"</span>,</span>
<span>    <span class="st">"iSEEtree"</span>,</span>
<span>    <span class="st">"mia"</span>,</span>
<span>    <span class="st">"miaViz"</span>,</span>
<span>    <span class="st">"scater"</span>,</span>
<span>    <span class="st">"shadowtext"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Get packages that are already installed</span></span>
<span><span class="va">packages_already_installed</span> <span class="op">&lt;-</span> <span class="va">packages</span><span class="op">[</span> <span class="va">packages</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span> <span class="op">]</span></span>
<span></span>
<span><span class="co"># Get packages that need to be installed</span></span>
<span><span class="va">packages_need_to_install</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span> <span class="va">packages</span>, <span class="va">packages_already_installed</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Loads BiocManager into the session. Install it if it is not already installed.</span></span>
<span><span class="kw">if</span><span class="op">(</span> <span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span><span class="op">)</span> <span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># If there are packages that need to be installed, installs them with BiocManager</span></span>
<span><span class="co"># Updates old packages.</span></span>
<span><span class="kw">if</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">packages_need_to_install</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span>version <span class="op">=</span> <span class="st">"devel"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="va">packages_need_to_install</span>, ask <span class="op">=</span> <span class="cn">FALSE</span>, update <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Load all packages into session. Stop if there are packages that were not</span></span>
<span><span class="co"># successfully loaded</span></span>
<span><span class="va">pkgs_not_loaded</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">packages</span>, <span class="va">require</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pkgs_not_loaded</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pkgs_not_loaded</span><span class="op">)</span><span class="op">[</span> <span class="va">pkgs_not_loaded</span> <span class="op">]</span></span>
<span><span class="kw">if</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pkgs_not_loaded</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span></span>
<span>        <span class="st">"Error in loading the following packages into the session: '"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">pkgs_not_loaded</span>, collapse <span class="op">=</span> <span class="st">"', '"</span><span class="op">)</span>, <span class="st">"'"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>If you encountered an error, install packages manually.</p>
</div>
<div class="section level3">
<h3 id="importing-data">Importing data<a class="anchor" aria-label="anchor" href="#importing-data"></a>
</h3>
<p>There are several openly available datasets listed in <a href="https://microbiome.github.io/OMA/docs/devel/pages/import.html#sec-example-data" class="external-link">OMA</a>.
In this workflow, we will retrieve data from the curatedMetagenomicData
resource. We’ll focus on a dataset that includes both colorectal cancer
(CRC) patients and control subjects. Our goal is to investigate whether
CRC is associated with alterations in the gut microbiota.</p>
<p>Let’s fetch the data from the database.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Study from which we want to fetch data</span></span>
<span><span class="va">study</span> <span class="op">&lt;-</span> <span class="st">"GuptaA_2019"</span></span>
<span><span class="co"># Experiments that we want to fetch</span></span>
<span><span class="va">experiments</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pathway_abundance"</span>, <span class="st">"relative_abundance"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">"|"</span><span class="op">)</span></span>
<span><span class="va">search_pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">study</span>, <span class="st">".("</span>, <span class="va">experiments</span>, <span class="st">")"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fetch data</span></span>
<span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu">curatedMetagenomicData</span><span class="op">(</span></span>
<span>    <span class="va">search_pattern</span>, dryrun <span class="op">=</span> <span class="cn">FALSE</span>, counts <span class="op">=</span> <span class="cn">TRUE</span>, rownames <span class="op">=</span> <span class="st">"short"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2021-03-31.GuptaA_2019.relative_abundance`</span></span>
<span><span class="co">#&gt; dropping rows without rowTree matches:</span></span>
<span><span class="co">#&gt;   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Collinsella|s__Collinsella_stercoris</span></span>
<span><span class="co">#&gt;   k__Bacteria|p__Actinobacteria|c__Coriobacteriia|o__Coriobacteriales|f__Coriobacteriaceae|g__Enorma|s__[Collinsella]_massiliensis</span></span>
<span><span class="co">#&gt;   k__Bacteria|p__Firmicutes|c__Bacilli|o__Lactobacillales|f__Carnobacteriaceae|g__Granulicatella|s__Granulicatella_elegans</span></span>
<span><span class="co">#&gt;   k__Bacteria|p__Firmicutes|c__Clostridia|o__Clostridiales|f__Ruminococcaceae|g__Ruminococcus|s__Ruminococcus_champanellensis</span></span>
<span><span class="co">#&gt;   k__Bacteria|p__Proteobacteria|c__Betaproteobacteria|o__Burkholderiales|f__Sutterellaceae|g__Sutterella|s__Sutterella_parvirubra</span></span>
<span></span>
<span><span class="co"># Add new names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pathway"</span>, <span class="st">"taxonomy"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The assay name for taxonomy profile is incorrect since we have counts, not</span></span>
<span><span class="co"># relative abundances</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="va">data_list</span><span class="op">[[</span><span class="st">"taxonomy"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">assayNames</span><span class="op">(</span><span class="va">tse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"counts"</span></span>
<span><span class="va">data_list</span><span class="op">[[</span><span class="st">"taxonomy"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tse</span></span>
<span></span>
<span><span class="co"># For pathway data, extract pathway information from rownames and add them to</span></span>
<span><span class="co"># rowData</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="va">data_list</span><span class="op">[[</span><span class="st">"pathway"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">tse</span><span class="op">)</span><span class="op">[[</span><span class="st">"full_name"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">tse</span><span class="op">)</span></span>
<span><span class="fu">rowData</span><span class="op">(</span><span class="va">tse</span><span class="op">)</span><span class="op">[[</span><span class="st">"pathway"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"\\|.*"</span>, <span class="st">""</span>, <span class="fu">rowData</span><span class="op">(</span><span class="va">tse</span><span class="op">)</span><span class="op">[[</span><span class="st">"full_name"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">data_list</span><span class="op">[[</span><span class="st">"pathway"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">tse</span></span>
<span></span>
<span><span class="co"># Get taxonomy object</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="va">data_list</span><span class="op">[[</span><span class="st">"taxonomy"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">tse</span></span>
<span><span class="co">#&gt; class: TreeSummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 304 60 </span></span>
<span><span class="co">#&gt; metadata(1): agglomerated_by_rank</span></span>
<span><span class="co">#&gt; assays(1): counts</span></span>
<span><span class="co">#&gt; rownames(304): [Bacteroides] pectinophilus [Clostridium] hylemonae ...</span></span>
<span><span class="co">#&gt;   Victivallis vadensis Weissella confusa</span></span>
<span><span class="co">#&gt; rowData names(7): superkingdom phylum ... genus species</span></span>
<span><span class="co">#&gt; colnames(60): GupDM_A_11 GupDM_A_15 ... GupDM_JO GupDM_JP</span></span>
<span><span class="co">#&gt; colData names(27): study_name subject_id ... disease_stage</span></span>
<span><span class="co">#&gt;   disease_location</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(0):</span></span>
<span><span class="co">#&gt; rowLinks: a LinkDataFrame (304 rows)</span></span>
<span><span class="co">#&gt; rowTree: 1 phylo tree(s) (10430 leaves)</span></span>
<span><span class="co">#&gt; colLinks: NULL</span></span>
<span><span class="co">#&gt; colTree: NULL</span></span></code></pre></div>
<p>The output is a <code>TreeSummarizedExperiment</code>
(<code>TreeSE</code>) object. For details on how to handle and access
the data, refer to <a href="https://microbiome.github.io/OMA/docs/devel/pages/containers.html" class="external-link">data
containers chapter in OMA</a>.</p>
</div>
<div class="section level3">
<h3 id="preprocess">Preprocess<a class="anchor" aria-label="anchor" href="#preprocess"></a>
</h3>
<p>A common step in microbiome workflows is agglomeration, where we
summarize data at specific taxonomy ranks. Additionally, preprocessing
involves transforming the data to address the unique characteristics of
microbiome profiling data, for instance. Details on agglomeration and
transformation are covered in <a href="https://microbiome.github.io/OMA/docs/devel/pages/agglomeration.html" class="external-link">agglomeration</a>
and <a href="https://microbiome.github.io/OMA/docs/devel/pages/transformation.html" class="external-link">transformation</a>
chapters in OMA, respectively.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agglomerate data</span></span>
<span><span class="va">tse_family</span> <span class="op">&lt;-</span> <span class="fu">agglomerateByRank</span><span class="op">(</span><span class="va">tse</span>, rank <span class="op">=</span> <span class="st">"family"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following values are already present in `metadata` and will be</span></span>
<span><span class="co">#&gt; overwritten: 'agglomerated_by_rank'. Consider using the 'name' argument to</span></span>
<span><span class="co">#&gt; specify alternative names.</span></span>
<span></span>
<span><span class="co"># Transform the main TreeSE</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span><span class="va">tse</span>, method <span class="op">=</span> <span class="st">"relabundance"</span><span class="op">)</span></span>
<span><span class="va">tse</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span><span class="va">tse</span>, method <span class="op">=</span> <span class="st">"clr"</span>, pseudocount <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Transform agglomerated data</span></span>
<span><span class="va">tse_family</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span><span class="va">tse_family</span>, method <span class="op">=</span> <span class="st">"relabundance"</span><span class="op">)</span></span>
<span><span class="va">tse_family</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span><span class="va">tse_family</span>, method <span class="op">=</span> <span class="st">"clr"</span>, pseudocount <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-community-diversity-and-composition">Analysis of community diversity and composition<a class="anchor" aria-label="anchor" href="#analysis-of-community-diversity-and-composition"></a>
</h2>
<p>Now that the data has been pre-processed, we could start to analyze
the overview of the microbiome profile. For the dataset above, we can
continue to perform analysis, for example to answer these questions:</p>
<ol style="list-style-type: decimal">
<li>How does the microbial community differ between the CRC (n=30) vs
healthy group (n=30)?</li>
</ol>
<p>2.How does the beta diversity compare between the CRC (n=30) vs
healthy group (n=30)?</p>
<ol start="3" style="list-style-type: decimal">
<li>What species shows significantly different relative abundance
between 2 groups?</li>
</ol>
<p>For those, let’s do the analysis in the species level.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agglomerate data</span></span>
<span><span class="va">tse_spec</span> <span class="op">&lt;-</span> <span class="fu">agglomerateByRank</span><span class="op">(</span><span class="va">tse</span>, rank <span class="op">=</span> <span class="st">"species"</span>, name<span class="op">=</span><span class="st">"species"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following values are already present in `metadata` and will be</span></span>
<span><span class="co">#&gt; overwritten: 'agglomerated_by_rank'. Consider using the 'name' argument to</span></span>
<span><span class="co">#&gt; specify alternative names.</span></span>
<span></span>
<span><span class="co"># Transform agglomerated data</span></span>
<span><span class="va">tse_spec</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span><span class="va">tse_spec</span>, method <span class="op">=</span> <span class="st">"relabundance"</span><span class="op">)</span></span>
<span><span class="va">tse_spec</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span><span class="va">tse_spec</span>, method <span class="op">=</span> <span class="st">"clr"</span>, pseudocount <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Let’s start with analyzing the differences on microbial community
diversity between CRC and healthy control group. Community diversity is
a central concept in microbiome research, and in the human microbiome
study it has been shown that the microbial diversity associated with the
host health status. Several diversity indices are available in the
ecological literature. You can explore further <a href="https://microbiome.github.io/OMA/docs/devel/pages/14_alpha_diversity.html" class="external-link">in
the OMA book</a> about what analysis in-term of community diversity can
be analyzed using mia package.</p>
<p>For simplicity, let’s calculate the microbial richness and alpha
diversity using the Shannon index (other calculation using different
index also available, and you can explore further)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse_spec</span> <span class="op">&lt;-</span> <span class="fu">estimateRichness</span><span class="op">(</span><span class="va">tse_spec</span>, </span>
<span>                             assay.type <span class="op">=</span> <span class="st">"counts"</span>, </span>
<span>                             index <span class="op">=</span> <span class="st">"observed"</span>, </span>
<span>                             name<span class="op">=</span><span class="st">"observed"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in estimateRichness(tse_spec, assay.type = "counts", index =</span></span>
<span><span class="co">#&gt; "observed", : 'estimateRichness' is deprecated. Use 'addAlpha' instead.</span></span>
<span></span>
<span><span class="va">tse_spec</span> <span class="op">&lt;-</span> <span class="fu">estimateDiversity</span><span class="op">(</span><span class="va">tse_spec</span>,</span>
<span>                              assay.type <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>                              index <span class="op">=</span> <span class="st">"shannon"</span>, </span>
<span>                              name <span class="op">=</span> <span class="st">"shannon"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in estimateDiversity(tse_spec, assay.type = "counts", index =</span></span>
<span><span class="co">#&gt; "shannon", : 'estimateDiversity' is deprecated. Use 'addAlpha' instead.</span></span>
<span><span class="co">#to see the shannon calculation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tse_spec</span><span class="op">$</span><span class="va">shannon</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.755092 1.044521 3.305171 2.744079 2.570301 2.937390</span></span></code></pre></div>
<p>To see the differences between healthy and CRC group, let’s visualize
the shannon diversity using violin plot (you can also experiment with
boxplot). The information about diseases state is available from the
colData of tse object, in the “diseases” column.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://const-ae.github.io/ggsignif/" class="external-link">ggsignif</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">tse_spec</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Changes old levels with new levels</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">disease</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="st">"disease"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># For significance testing, all different combinations are determined</span></span>
<span><span class="va">comb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">disease</span> <span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, </span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">disease</span> <span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Observed richness plot</span></span>
<span><span class="va">observed_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">disease</span>, y <span class="op">=</span> <span class="va">observed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://const-ae.github.io/ggsignif/reference/stat_signif.html" class="external-link">geom_signif</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">comb</span>, map_signif_level <span class="op">=</span> <span class="cn">FALSE</span>, correction <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Observed Richness"</span>, y <span class="op">=</span> <span class="st">"Observed Species"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in geom_signif(comparisons = comb, map_signif_level = FALSE, correction</span></span>
<span><span class="co">#&gt; = "fdr"): Ignoring unknown parameters: `correction`</span></span>
<span></span>
<span><span class="co"># Shannon diversity plot</span></span>
<span><span class="va">shannon_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">disease</span>, y <span class="op">=</span> <span class="va">shannon</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://const-ae.github.io/ggsignif/reference/stat_signif.html" class="external-link">geom_signif</a></span><span class="op">(</span>comparisons <span class="op">=</span> <span class="va">comb</span>, map_signif_level <span class="op">=</span> <span class="cn">FALSE</span>, correction <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Shannon Diversity"</span>, y <span class="op">=</span> <span class="st">"Shannon Index"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in geom_signif(comparisons = comb, map_signif_level = FALSE, correction</span></span>
<span><span class="co">#&gt; = "fdr"): Ignoring unknown parameters: `correction`</span></span>
<span></span>
<span><span class="co"># Combine the two plots into a grid</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="va">observed_plot</span> <span class="op">+</span> <span class="va">shannon_plot</span></span>
<span></span>
<span><span class="co"># Display the combined plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_plot</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in wilcox.test.default(c(55, 29, 148, 68, 63, 51, 37, 44, 45, 61, :</span></span>
<span><span class="co">#&gt; cannot compute exact p-value with ties</span></span></code></pre></div>
<p><img src="eccb_workflow_files/figure-html/alpha%20diversity%20viz-1.png" width="700"></p>
<p><strong>Thinking box</strong> &gt; Can you also do the diversity
analysis using different indexes? &gt; What can you inffer by this
observation?</p>
</div>
<div class="section level2">
<h2 id="microbiome-data-integration">Microbiome data integration<a class="anchor" aria-label="anchor" href="#microbiome-data-integration"></a>
</h2>
<p>As demonstrated, CRC patients appear to have altered microbiota.
However, this observation only indicates an association and does not
imply causality or reveal underlying mechanisms. To explore complex
mechanisms, we often need more comprehensive data. Efficiently handling
data from multiple experiments requires integrating these datasets into
a unified data container. Bioconductor offers two approaches for
this:</p>
<ul>
<li>Using the <code>altExp</code> slot within the <code>TreeSE</code>
object, which is a straightforward method.</li>
<li>Employing <code>MultiAssayExperiment</code>, a more general and
flexible approach, though it comes with a more complex data structure
compared to <code>TreeSE</code>.</li>
</ul>
<p>For detailed information on both approaches, refer to <a href="https://microbiome.github.io/OMA/docs/devel/pages/containers.html" class="external-link">OMA</a>.
In this tutorial, we will focus on the simpler method using the
<code>altExp</code> slot.</p>
<p>The data fetched at the beginning of this workflow is a
<code>list</code> containing multiple experiments, each represented as a
unique <code>(Tree)SE</code> object. Managing this list and the
connections between samples can be error-prone and cumbersome. To
simplify this, we can use the <code>altExp</code> slot to handle the
bookkeeping. Let’s start by checking which experiments are
available:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pathway"  "taxonomy"</span></span></code></pre></div>
<p>As we see, we have metabolic pathway predictions in addition to
taxonomic profiling. We can add the entire list of experiments to the
<code>altExp</code> slot.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">altExps</span><span class="op">(</span><span class="va">tse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">data_list</span></span>
<span><span class="va">tse</span></span>
<span><span class="co">#&gt; class: TreeSummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 304 60 </span></span>
<span><span class="co">#&gt; metadata(1): agglomerated_by_rank</span></span>
<span><span class="co">#&gt; assays(3): counts relabundance clr</span></span>
<span><span class="co">#&gt; rownames(304): [Bacteroides] pectinophilus [Clostridium] hylemonae ...</span></span>
<span><span class="co">#&gt;   Victivallis vadensis Weissella confusa</span></span>
<span><span class="co">#&gt; rowData names(7): superkingdom phylum ... genus species</span></span>
<span><span class="co">#&gt; colnames(60): GupDM_A_11 GupDM_A_15 ... GupDM_JO GupDM_JP</span></span>
<span><span class="co">#&gt; colData names(27): study_name subject_id ... disease_stage</span></span>
<span><span class="co">#&gt;   disease_location</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(2): pathway taxonomy</span></span>
<span><span class="co">#&gt; rowLinks: a LinkDataFrame (304 rows)</span></span>
<span><span class="co">#&gt; rowTree: 1 phylo tree(s) (10430 leaves)</span></span>
<span><span class="co">#&gt; colLinks: NULL</span></span>
<span><span class="co">#&gt; colTree: NULL</span></span></code></pre></div>
<p>With the <code>altExp</code> slot now populated, you can access the
data using the <code>altExp()</code> function and specify which
experiment you want to retrieve.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway"</span><span class="op">)</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 12535 60 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(1): pathway_abundance</span></span>
<span><span class="co">#&gt; rownames(12535): UNMAPPED UNINTEGRATED ... PWY-7197: pyrimidine</span></span>
<span><span class="co">#&gt;   deoxyribonucleotide</span></span>
<span><span class="co">#&gt;   phosphorylation|g__Desulfovibrio.s__Desulfovibrio_piger PWY-6703:</span></span>
<span><span class="co">#&gt;   preQ0 biosynthesis|g__Butyricimonas.s__Butyricimonas_virosa</span></span>
<span><span class="co">#&gt; rowData names(2): full_name pathway</span></span>
<span><span class="co">#&gt; colnames(60): GupDM_A_11 GupDM_A_15 ... GupDM_JO GupDM_JP</span></span>
<span><span class="co">#&gt; colData names(27): study_name subject_id ... disease_stage</span></span>
<span><span class="co">#&gt;   disease_location</span></span></code></pre></div>
<p>As mentioned earlier, the advantage of the <code>altExp</code> slot
is that it handles sample linkages for us. For example, if we select a
subset of data, the object automatically subsets all associated
experiments accordingly.</p>
<p>For example, let’s select only the samples from senior patients.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tse_sub</span> <span class="op">&lt;-</span> <span class="va">tse</span><span class="op">[</span> , <span class="va">tse</span><span class="op">$</span><span class="va">age_category</span> <span class="op">==</span> <span class="st">"senior"</span><span class="op">]</span></span>
<span><span class="va">tse_sub</span></span>
<span><span class="co">#&gt; class: TreeSummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 304 8 </span></span>
<span><span class="co">#&gt; metadata(1): agglomerated_by_rank</span></span>
<span><span class="co">#&gt; assays(3): counts relabundance clr</span></span>
<span><span class="co">#&gt; rownames(304): [Bacteroides] pectinophilus [Clostridium] hylemonae ...</span></span>
<span><span class="co">#&gt;   Victivallis vadensis Weissella confusa</span></span>
<span><span class="co">#&gt; rowData names(7): superkingdom phylum ... genus species</span></span>
<span><span class="co">#&gt; colnames(8): GupDM_A4 GupDM_A5 ... GupDM_JO GupDM_JP</span></span>
<span><span class="co">#&gt; colData names(27): study_name subject_id ... disease_stage</span></span>
<span><span class="co">#&gt;   disease_location</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(2): pathway taxonomy</span></span>
<span><span class="co">#&gt; rowLinks: a LinkDataFrame (304 rows)</span></span>
<span><span class="co">#&gt; rowTree: 1 phylo tree(s) (10430 leaves)</span></span>
<span><span class="co">#&gt; colLinks: NULL</span></span>
<span><span class="co">#&gt; colTree: NULL</span></span>
<span></span>
<span><span class="co"># Check that all sample names still match</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse_sub</span>, <span class="st">"pathway"</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tse_sub</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Now, we can see that the data has been successfully subsetted, with
all sample names matching across experiments.</p>
<p>In addition to adding the entire list, we can also add individual
experiments. Let’s add the agglomerated data separately to keep the
whole dataset organized.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"family"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tse_family</span></span>
<span><span class="va">tse</span></span>
<span><span class="co">#&gt; class: TreeSummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 304 60 </span></span>
<span><span class="co">#&gt; metadata(1): agglomerated_by_rank</span></span>
<span><span class="co">#&gt; assays(3): counts relabundance clr</span></span>
<span><span class="co">#&gt; rownames(304): [Bacteroides] pectinophilus [Clostridium] hylemonae ...</span></span>
<span><span class="co">#&gt;   Victivallis vadensis Weissella confusa</span></span>
<span><span class="co">#&gt; rowData names(7): superkingdom phylum ... genus species</span></span>
<span><span class="co">#&gt; colnames(60): GupDM_A_11 GupDM_A_15 ... GupDM_JO GupDM_JP</span></span>
<span><span class="co">#&gt; colData names(27): study_name subject_id ... disease_stage</span></span>
<span><span class="co">#&gt;   disease_location</span></span>
<span><span class="co">#&gt; reducedDimNames(0):</span></span>
<span><span class="co">#&gt; mainExpName: NULL</span></span>
<span><span class="co">#&gt; altExpNames(3): pathway taxonomy family</span></span>
<span><span class="co">#&gt; rowLinks: a LinkDataFrame (304 rows)</span></span>
<span><span class="co">#&gt; rowTree: 1 phylo tree(s) (10430 leaves)</span></span>
<span><span class="co">#&gt; colLinks: NULL</span></span>
<span><span class="co">#&gt; colTree: NULL</span></span></code></pre></div>
<p>Now that the entire dataset is well-organized and in one place, let’s
dive into analyzing the interconnections between experiments.
Specifically, we’ll examine whether the abundance of certain bacteria is
associated with specific metabolic activity pathway.</p>
<p>We’ll perform a simple cross-association analysis to explore these
relationships. First, we’ll preprocess the functional annotation data by
agglomerating the pathways based on each pathway’s function, and then
further by prevalence.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Agglomerate based on pathways function</span></span>
<span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway_func"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">agglomerateByVariable</span><span class="op">(</span></span>
<span>    <span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway"</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"rows"</span>,</span>
<span>    f <span class="op">=</span> <span class="st">"pathway"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co"># Agglomerate based on prevalence</span></span>
<span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway_prev"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">agglomerateByPrevalence</span><span class="op">(</span></span>
<span>    <span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway_func"</span><span class="op">)</span>,</span>
<span>    assay.type <span class="op">=</span> <span class="st">"pathway_abundance"</span>,</span>
<span>    prevalence <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    detection <span class="op">=</span> <span class="fl">0.001</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The data now includes the most prevalent pathways, each representing
a single metabolic activity. Next, we apply a transformation as the
final preprocessing step for our functional data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway_prev"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">transformAssay</span><span class="op">(</span></span>
<span>    <span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway_prev"</span><span class="op">)</span>,</span>
<span>    assay.type <span class="op">=</span> <span class="st">"pathway_abundance"</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"clr"</span>,</span>
<span>    pseudocount <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The assay contains only positive values. Applying a pseudocount may be</span></span>
<span><span class="co">#&gt; unnecessary.</span></span>
<span><span class="fu">altExp</span><span class="op">(</span><span class="va">tse</span>, <span class="st">"pathway_prev"</span><span class="op">)</span></span>
<span><span class="co">#&gt; class: SummarizedExperiment </span></span>
<span><span class="co">#&gt; dim: 24 60 </span></span>
<span><span class="co">#&gt; metadata(0):</span></span>
<span><span class="co">#&gt; assays(2): pathway_abundance clr</span></span>
<span><span class="co">#&gt; rownames(24): BRANCHED-CHAIN-AA-SYN-PWY: superpathway of branched amino</span></span>
<span><span class="co">#&gt;   acid biosynthesis DTDPRHAMSYN-PWY: dTDP-L-rhamnose biosynthesis I ...</span></span>
<span><span class="co">#&gt;   VALSYN-PWY: L-valine biosynthesis Other</span></span>
<span><span class="co">#&gt; rowData names(2): full_name pathway</span></span>
<span><span class="co">#&gt; colnames(60): GupDM_A_11 GupDM_A_15 ... GupDM_JO GupDM_JP</span></span>
<span><span class="co">#&gt; colData names(27): study_name subject_id ... disease_stage</span></span>
<span><span class="co">#&gt;   disease_location</span></span></code></pre></div>
<p>We’re now ready to perform the cross-association analysis. We will
examine the associations between microbial families and the most
abundant pathways. To visualize the results, we’ll use a heatmap.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform cross-associaton</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">getCrossAssociation</span><span class="op">(</span></span>
<span>    <span class="va">tse</span>,</span>
<span>    altexp1 <span class="op">=</span> <span class="st">"family"</span>,</span>
<span>    altexp2 <span class="op">=</span> <span class="st">"pathway_prev"</span>,</span>
<span>    assay.type1 <span class="op">=</span> <span class="st">"clr"</span>,</span>
<span>    assay.type2 <span class="op">=</span> <span class="st">"clr"</span>,</span>
<span>    mode <span class="op">=</span> <span class="st">"matrix"</span>,</span>
<span>    test.signif <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; Calculating correlations...</span></span>
<span><span class="co">#&gt; altexp1: family, altexp2: pathway_prev, assay.type1: clr, col.var1: -, assay.type2: clr, col.var2: -</span></span>
<span><span class="co">#&gt; by: 1, function: stats::cor.test, method: kendall, test.signif: TRUE, p.adj.method: fdr, paired: FALSE, show.warnings: TRUE</span></span>
<span><span class="co">#&gt; Converting table into matrices...</span></span>
<span></span>
<span><span class="co"># Function for marking significant correlations with "X"</span></span>
<span><span class="va">add_signif</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">j</span>, <span class="va">i</span>, <span class="va">x</span>, <span class="va">y</span>, <span class="va">width</span>, <span class="va">height</span>, <span class="va">fill</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># If the p-value is under threshold</span></span>
<span>    <span class="kw">if</span><span class="op">(</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">p_adj</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">res</span><span class="op">$</span><span class="va">p_adj</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0.05</span> <span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co"># Print "X"</span></span>
<span>        <span class="fu">grid.shadowtext</span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s"</span>, <span class="st">"X"</span><span class="op">)</span>, <span class="va">x</span>, <span class="va">y</span>, gp <span class="op">=</span> <span class="fu">gpar</span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">8</span>, col <span class="op">=</span> <span class="st">"#f5f5f5"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create a heatmap</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">Heatmap</span><span class="op">(</span></span>
<span>    <span class="va">res</span><span class="op">$</span><span class="va">cor</span>,</span>
<span>    <span class="co"># Print values to cells</span></span>
<span>    cell_fun <span class="op">=</span> <span class="va">add_signif</span>,</span>
<span>    heatmap_legend_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title <span class="op">=</span> <span class="st">"correlation"</span>, legend_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">5</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    column_names_rot <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    column_names_max_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">20</span>, <span class="st">"cm"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="eccb_workflow_files/figure-html/cross_association-1.png" width="1440"></p>
<p>Enterobacteriaceae shows a positive correlation with certain pathways
(indicated by x, which denotes statistical significance with an adjusted
p-value &lt; 0.05) that other microbial families are negatively
correlated with. For example, L-isoleucine biosynthesis is a pathway
that demonstrates this kind of association.</p>
<p>For more information on data integration, see the following
sections:</p>
<ul>
<li><a href="https://microbiome.github.io/OMA/docs/devel/pages/cross_correlation.html" class="external-link">Cross-association</a></li>
<li><a href="https://microbiome.github.io/OMA/docs/devel/pages/multiassay_ordination.html" class="external-link">Ordination-based
Multiassay Analysis</a></li>
<li><a href="https://microbiome.github.io/OMA/docs/devel/pages/integrated_learner.html" class="external-link">Multi-assay
classification</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="microbial-network-analysis">Microbial network analysis<a class="anchor" aria-label="anchor" href="#microbial-network-analysis"></a>
</h2>
</div>
<div class="section level2">
<h2 id="interactive-microbiome-data-exploration-with-iseetree">Interactive microbiome data exploration with iSEEtree<a class="anchor" aria-label="anchor" href="#interactive-microbiome-data-exploration-with-iseetree"></a>
</h2>
<p><a href="https://microbiome.github.io/iSEEtree/" class="external-link">iSEEtree</a> is a
shiny app that provides a Graphical User Interface (GUI) to visualize
and interactively explore TreeSE objects. We will demonstrate its
capability by reproducing some of the plots that were previously created
in this workshop, this time without the need of coding.</p>
<p>Launching the app is easy. All you need to do is run the command
<code>iSEE</code> on the TreeSE object that you want to explore.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/microbiome/iSEEtree" class="external-link">iSEEtree</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Launch app</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/iSEEtree/man/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">tse_family</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The default panel layout does not contain the so-called
<code>ColumnDataTable</code> panel, which plots variables from the
<code>colData.</code> Therefore, we need to specify a custom panel
layout with the <code>initial</code> argument to generate the alpha
diversity plot.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Launch app with custom layout</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/iSEEtree/man/iSEE.html" class="external-link">iSEE</a></span><span class="op">(</span><span class="va">tse_family</span>, initial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataTable-class.html" class="external-link">ColumnDataTable</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/iSEE/man/ColumnDataPlot-class.html" class="external-link">ColumnDataPlot</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>If interested, you can explore further functionality and the panel
catalogue in the <a href="https://microbiome.github.io/iSEEtree/articles/iSEEtree.html" class="external-link">iSEEtree
vignettes</a>.</p>
<p>Ideas for self-learning:</p>
<ul>
<li>Learn what different panels show by reading their help page</li>
<li>Adjust a plot to deliver the message you want</li>
<li>Use selection parameters to show a subset of the data</li>
<li>Save a plot to image and/or access its R code</li>
</ul>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.4 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Etc/UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    grid      stats     graphics  grDevices utils     datasets </span></span>
<span><span class="co">#&gt; [8] methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] patchwork_1.2.0                 ggsignif_0.6.4                 </span></span>
<span><span class="co">#&gt;  [3] shadowtext_0.1.4                scater_1.33.4                  </span></span>
<span><span class="co">#&gt;  [5] scuttle_1.15.4                  miaViz_1.13.10                 </span></span>
<span><span class="co">#&gt;  [7] ggraph_2.2.1                    ggplot2_3.5.1                  </span></span>
<span><span class="co">#&gt;  [9] mia_1.13.38                     MultiAssayExperiment_1.31.5    </span></span>
<span><span class="co">#&gt; [11] iSEEtree_0.99.6                 iSEE_2.17.4                    </span></span>
<span><span class="co">#&gt; [13] curatedMetagenomicData_3.13.0   TreeSummarizedExperiment_2.13.0</span></span>
<span><span class="co">#&gt; [15] Biostrings_2.73.1               XVector_0.45.0                 </span></span>
<span><span class="co">#&gt; [17] SingleCellExperiment_1.27.2     SummarizedExperiment_1.35.1    </span></span>
<span><span class="co">#&gt; [19] Biobase_2.65.1                  GenomicRanges_1.57.1           </span></span>
<span><span class="co">#&gt; [21] GenomeInfoDb_1.41.1             IRanges_2.39.2                 </span></span>
<span><span class="co">#&gt; [23] S4Vectors_0.43.2                BiocGenerics_0.51.1            </span></span>
<span><span class="co">#&gt; [25] MatrixGenerics_1.17.0           matrixStats_1.4.1              </span></span>
<span><span class="co">#&gt; [27] ComplexHeatmap_2.21.0           BiocManager_1.30.25            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] fs_1.6.4                    DirichletMultinomial_1.47.0</span></span>
<span><span class="co">#&gt;   [3] httr_1.4.7                  RColorBrewer_1.1-3         </span></span>
<span><span class="co">#&gt;   [5] doParallel_1.0.17           tools_4.4.1                </span></span>
<span><span class="co">#&gt;   [7] backports_1.5.0             utf8_1.2.4                 </span></span>
<span><span class="co">#&gt;   [9] R6_2.5.1                    DT_0.33                    </span></span>
<span><span class="co">#&gt;  [11] vegan_2.6-8                 lazyeval_0.2.2             </span></span>
<span><span class="co">#&gt;  [13] mgcv_1.9-1                  GetoptLong_1.0.5           </span></span>
<span><span class="co">#&gt;  [15] permute_0.9-7               withr_3.0.1                </span></span>
<span><span class="co">#&gt;  [17] gridExtra_2.3               cli_3.6.3                  </span></span>
<span><span class="co">#&gt;  [19] textshaping_0.4.0           Cairo_1.6-2                </span></span>
<span><span class="co">#&gt;  [21] shinyjs_2.1.0               sandwich_3.1-0             </span></span>
<span><span class="co">#&gt;  [23] labeling_0.4.3              slam_0.1-53                </span></span>
<span><span class="co">#&gt;  [25] sass_0.4.9                  mvtnorm_1.3-1              </span></span>
<span><span class="co">#&gt;  [27] pkgdown_2.1.0               systemfonts_1.1.0          </span></span>
<span><span class="co">#&gt;  [29] yulab.utils_0.1.7           foreign_0.8-87             </span></span>
<span><span class="co">#&gt;  [31] decontam_1.25.0             rstudioapi_0.16.0          </span></span>
<span><span class="co">#&gt;  [33] RSQLite_2.3.7               gridGraphics_0.5-1         </span></span>
<span><span class="co">#&gt;  [35] generics_0.1.3              shape_1.4.6.1              </span></span>
<span><span class="co">#&gt;  [37] dplyr_1.1.4                 rbiom_1.0.3                </span></span>
<span><span class="co">#&gt;  [39] Matrix_1.7-0                ggbeeswarm_0.7.2           </span></span>
<span><span class="co">#&gt;  [41] fansi_1.0.6                 DECIPHER_3.1.4             </span></span>
<span><span class="co">#&gt;  [43] abind_1.4-5                 lifecycle_1.0.4            </span></span>
<span><span class="co">#&gt;  [45] yaml_2.3.10                 SparseArray_1.5.34         </span></span>
<span><span class="co">#&gt;  [47] BiocFileCache_2.13.0        blob_1.2.4                 </span></span>
<span><span class="co">#&gt;  [49] promises_1.3.0              ExperimentHub_2.13.1       </span></span>
<span><span class="co">#&gt;  [51] crayon_1.5.3                shinydashboard_0.7.2       </span></span>
<span><span class="co">#&gt;  [53] miniUI_0.1.1.1              lattice_0.22-6             </span></span>
<span><span class="co">#&gt;  [55] beachmat_2.21.6             KEGGREST_1.45.1            </span></span>
<span><span class="co">#&gt;  [57] pillar_1.9.0                knitr_1.48                 </span></span>
<span><span class="co">#&gt;  [59] rjson_0.2.22                boot_1.3-31                </span></span>
<span><span class="co">#&gt;  [61] lpSolve_5.6.20              codetools_0.2-20           </span></span>
<span><span class="co">#&gt;  [63] glue_1.7.0                  ggfun_0.1.6                </span></span>
<span><span class="co">#&gt;  [65] data.table_1.16.0           vctrs_0.6.5                </span></span>
<span><span class="co">#&gt;  [67] png_0.1-8                   treeio_1.29.1              </span></span>
<span><span class="co">#&gt;  [69] gtable_0.3.5                cachem_1.1.0               </span></span>
<span><span class="co">#&gt;  [71] xfun_0.47                   S4Arrays_1.5.7             </span></span>
<span><span class="co">#&gt;  [73] mime_0.12                   tidygraph_1.3.1            </span></span>
<span><span class="co">#&gt;  [75] iterators_1.0.14            bluster_1.15.1             </span></span>
<span><span class="co">#&gt;  [77] nlme_3.1-166                ggtree_3.13.1              </span></span>
<span><span class="co">#&gt;  [79] bit64_4.0.5                 filelock_1.0.3             </span></span>
<span><span class="co">#&gt;  [81] SnowballC_0.7.1             bslib_0.8.0                </span></span>
<span><span class="co">#&gt;  [83] irlba_2.3.5.1               vipor_0.4.7                </span></span>
<span><span class="co">#&gt;  [85] rpart_4.1.23                colorspace_2.1-1           </span></span>
<span><span class="co">#&gt;  [87] DBI_1.2.3                   Hmisc_5.1-3                </span></span>
<span><span class="co">#&gt;  [89] nnet_7.3-19                 tidyselect_1.2.1           </span></span>
<span><span class="co">#&gt;  [91] bit_4.0.5                   compiler_4.4.1             </span></span>
<span><span class="co">#&gt;  [93] curl_5.2.2                  htmlTable_2.4.3            </span></span>
<span><span class="co">#&gt;  [95] BiocNeighbors_1.99.0        desc_1.4.3                 </span></span>
<span><span class="co">#&gt;  [97] DelayedArray_0.31.11        colourpicker_1.3.0         </span></span>
<span><span class="co">#&gt;  [99] checkmate_2.3.2             scales_1.3.0               </span></span>
<span><span class="co">#&gt; [101] rappdirs_0.3.3              stringr_1.5.1              </span></span>
<span><span class="co">#&gt; [103] digest_0.6.37               minqa_1.2.8                </span></span>
<span><span class="co">#&gt; [105] rmarkdown_2.28              htmltools_0.5.8.1          </span></span>
<span><span class="co">#&gt; [107] pkgconfig_2.0.3             base64enc_0.1-3            </span></span>
<span><span class="co">#&gt; [109] lme4_1.1-35.5               sparseMatrixStats_1.17.2   </span></span>
<span><span class="co">#&gt; [111] highr_0.11                  dbplyr_2.5.0               </span></span>
<span><span class="co">#&gt; [113] listviewer_4.0.0            fastmap_1.2.0              </span></span>
<span><span class="co">#&gt; [115] rlang_1.1.4                 GlobalOptions_0.1.2        </span></span>
<span><span class="co">#&gt; [117] htmlwidgets_1.6.4           UCSC.utils_1.1.0           </span></span>
<span><span class="co">#&gt; [119] shiny_1.9.1                 DelayedMatrixStats_1.27.3  </span></span>
<span><span class="co">#&gt; [121] farver_2.1.2                jquerylib_0.1.4            </span></span>
<span><span class="co">#&gt; [123] zoo_1.8-12                  jsonlite_1.8.8             </span></span>
<span><span class="co">#&gt; [125] BiocParallel_1.39.0         tokenizers_0.3.0           </span></span>
<span><span class="co">#&gt; [127] BiocSingular_1.21.3         magrittr_2.0.3             </span></span>
<span><span class="co">#&gt; [129] Formula_1.2-5               GenomeInfoDbData_1.2.12    </span></span>
<span><span class="co">#&gt; [131] ggplotify_0.1.2             munsell_0.5.1              </span></span>
<span><span class="co">#&gt; [133] Rcpp_1.0.13                 ape_5.8                    </span></span>
<span><span class="co">#&gt; [135] ggnewscale_0.5.0            viridis_0.6.5              </span></span>
<span><span class="co">#&gt; [137] stringi_1.8.4               rintrojs_0.3.4             </span></span>
<span><span class="co">#&gt; [139] zlibbioc_1.51.1             MASS_7.3-61                </span></span>
<span><span class="co">#&gt; [141] AnnotationHub_3.13.3        plyr_1.8.9                 </span></span>
<span><span class="co">#&gt; [143] mediation_4.5.0             parallel_4.4.1             </span></span>
<span><span class="co">#&gt; [145] ggrepel_0.9.6               graphlayouts_1.1.1         </span></span>
<span><span class="co">#&gt; [147] splines_4.4.1               circlize_0.4.16            </span></span>
<span><span class="co">#&gt; [149] igraph_2.0.3                reshape2_1.4.4             </span></span>
<span><span class="co">#&gt; [151] ScaledMatrix_1.13.0         BiocVersion_3.20.0         </span></span>
<span><span class="co">#&gt; [153] evaluate_0.24.0             tidytext_0.4.2             </span></span>
<span><span class="co">#&gt; [155] RcppParallel_5.1.9          nloptr_2.1.1               </span></span>
<span><span class="co">#&gt; [157] foreach_1.5.2               tweenr_2.0.3               </span></span>
<span><span class="co">#&gt; [159] httpuv_1.6.15               tidyr_1.3.1                </span></span>
<span><span class="co">#&gt; [161] purrr_1.0.2                 polyclip_1.10-7            </span></span>
<span><span class="co">#&gt; [163] clue_0.3-65                 ggforce_0.4.2              </span></span>
<span><span class="co">#&gt; [165] rsvd_1.0.5                  xtable_1.8-4               </span></span>
<span><span class="co">#&gt; [167] tidytree_0.4.6              janeaustenr_1.0.0          </span></span>
<span><span class="co">#&gt; [169] later_1.3.2                 viridisLite_0.4.2          </span></span>
<span><span class="co">#&gt; [171] ragg_1.3.3                  tibble_3.2.1               </span></span>
<span><span class="co">#&gt; [173] aplot_0.2.3                 memoise_2.0.1              </span></span>
<span><span class="co">#&gt; [175] beeswarm_0.4.0              AnnotationDbi_1.67.0       </span></span>
<span><span class="co">#&gt; [177] cluster_2.1.6               shinyWidgets_0.8.6         </span></span>
<span><span class="co">#&gt; [179] shinyAce_0.4.2</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Tuomas Borman, Leo Lahti.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
